<nav class="navbar">
    <div class="navbar-container">
        <a routerLink="/" class="navbar-brand">E-Shop</a>

        <div class="navbar-search">
            <div class="search-wrapper">
                <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none"
                    stroke-linecap="round" stroke-linejoin="round" class="search-icon">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" class="search-input" placeholder="Tìm kiếm sản phẩm, cửa hàng...">
                <button class="search-btn">Tìm kiếm</button>
            </div>
        </div>

        <div class="navbar-toggle" (click)="toggleMenu()">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </div>

        <div class="navbar-menu" [class.active]="isMenuOpen">
            <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-link"
                (click)="closeMenu()">Home</a>
            <a routerLink="/products" routerLinkActive="active" class="nav-link" (click)="closeMenu()">Products</a>
            <a routerLink="/about" routerLinkActive="active" class="nav-link" (click)="closeMenu()">About</a>
            <a routerLink="/contact" routerLinkActive="active" class="nav-link" (click)="closeMenu()">Contact</a>

            <div class="navbar-auth" *ngIf="(currentUser$ | async) === null; else userMenu">
                <a routerLink="/auth/login" class="btn-link" (click)="closeMenu()">Login</a>
                <app-button routerLink="/auth/register" variant="primary" size="sm"
                    (click)="closeMenu()">Register</app-button>
            </div>

            <ng-template #userMenu>
                <div class="user-profile-menu">
                    <div class="user-avatar" (click)="toggleProfileDropdown()">
                        <img [src]="(currentUser$ | async)?.avatarUrl" alt="User Avatar">
                        <span>{{ (currentUser$ | async)?.name }}</span>
                    </div>
                    <div class="dropdown-menu" *ngIf="isProfileDropdownOpen">
                        <a routerLink="/profile" class="dropdown-item" (click)="closeMenu()">Profile</a>
                        <a routerLink="/settings" class="dropdown-item" (click)="closeMenu()">Settings</a>
                        <div class="dropdown-divider"></div>
                        <button (click)="logout(); closeMenu()" class="dropdown-item text-danger">Logout</button>
                    </div>
                </div>
            </ng-template>
        </div>
    </div>
</nav>